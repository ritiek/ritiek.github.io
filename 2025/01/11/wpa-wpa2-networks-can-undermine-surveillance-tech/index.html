<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" as="font" href="https://ritiek.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://ritiek.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2"  type="font/woff2" crossorigin>


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&family=PT+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://ritiek.github.io/main.css?v=1761438477">
<link rel="stylesheet" href="https://ritiek.github.io/custom.css?v=1761438477">



  
  
  
  
  
    
  

  
  
    
    
  
  
  
    
  
  
  
  
    
  
  
  


  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">


	


	

<title>WPA/WPA2 networks can undermine surveillance tech | Ritiek Malhotra</title>
<meta name="description" content="Just some of my adventures!">
<link rel="canonical" href="https://ritiek.github.io/2025/01/11/wpa-wpa2-networks-can-undermine-surveillance-tech/">


  <meta name="twitter:card" content="summary_large_image">
  
  <meta name="twitter:title" content="WPA&#x2F;WPA2 networks can undermine surveillance tech">
  <meta name="twitter:description" content="Just some of my adventures!">
  <meta name="twitter:site" content="@">
  <meta name="twitter:creator" content="@">
  
  <meta property="og:title" content="WPA&#x2F;WPA2 networks can undermine surveillance tech">
  <meta property="og:description" content="Just some of my adventures!">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://ritiek.github.io/2025/01/11/wpa-wpa2-networks-can-undermine-surveillance-tech/">

  

  <meta property="og:updated_time" content="">
  <meta property="og:site_name" content="WPA&#x2F;WPA2 networks can undermine surveillance tech">

  

  

  
  <meta property="article:publisher" content="https://www.facebook.com/">
  <meta property="article:author" content="https://www.facebook.com/">
  <meta property="og:locale" content="en_US">









<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    
      
      
        
        
        
        
        
        
        
        
          {
            "@type": "ListItem",
            "position":  1 ,
            "name": "Home",
            "item": "https://ritiek.github.io/"
          },
          
          
          {
            "@type": "ListItem",
            "position":  2 ,
            "name": "2025",
            "item": "https://ritiek.github.io/2025/"
          },
        
      
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  3 ,
            "name": "01",
            "item": "https://ritiek.github.io/2025/01/"
          },
        
      
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  4 ,
            "name": "11",
            "item": "https://ritiek.github.io/2025/01/11/"
          },
        
      
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  5 ,
            "name": "Wpa Wpa2 Networks Can Undermine Surveillance Tech",
            "item": "https://ritiek.github.io/2025/01/11/wpa-wpa2-networks-can-undermine-surveillance-tech/"
          },
        
      
    
  }
</script>







  <meta name="theme-color" content="#fff">
  <link rel="apple-touch-icon" sizes="180x180" href="https://ritiek.github.io/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://ritiek.github.io/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://ritiek.github.io/favicon-16x16.png">
  
    <link rel="manifest" href="https://ritiek.github.io/site.webmanifest" crossorigin>
  


  

</head>

  

<body class="blog single">
  
  
<div class="header-bar fixed-top"></div>
<header class="navbar fixed-top navbar-expand-md navbar-light">
	<div class="container">
		<input class="menu-btn order-0" type="checkbox" id="menu-btn">
		<label class="menu-icon d-md-none" for="menu-btn"><span class="navicon"></span></label>
		<a class="navbar-brand order-1 order-md-0 me-auto" href="https://ritiek.github.io">Ritiek Malhotra</a>
		<button id="mode" class="btn btn-link order-2 order-md-4" type="button" aria-label="Toggle mode">
			<span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>
			<span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
		</button>
		<ul class="navbar-nav fork-me order-3 order-md-5">
			
				
					<li class="nav-item">
						<a class="nav-link" href="https://github.com/ritiek"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg><span class="ms-2 visually-hidden">GitHub</span></a>
					</li>
				
			
		</ul>
		<div class="collapse navbar-collapse order-4 order-md-1">
			<ul class="navbar-nav main-nav me-auto order-5 order-md-2">
				
					
				
				
				
					
						<li class="nav-item">
							<a class="nav-link" href="/posts/">Archive</a>
						</li>
					
						<li class="nav-item">
							<a class="nav-link" href="/about/">About</a>
						</li>
					
				
			</ul>
			<div class="break order-6 d-md-none"></div>
			
				<form class="navbar-form flex-grow-1 order-7 order-md-3">
					<input id="userinput" class="form-control is-search" type="search" placeholder="Search posts..."
						aria-label="Search posts..." autocomplete="off">
					<div id="suggestions" class="shadow bg-white rounded"></div>
				</form>
			
		</div>
	</div>

</header>



  
<div class="wrap container" role="document">
  <div class="content">
    <div class="row justify-content-center">
      <div class="col-md-12 col-lg-10 col-xxl-8">
        <article>
          <div class="blog-header">
            <h1>WPA&#x2F;WPA2 networks can undermine surveillance tech</h1>
            
<p><small>11 Jan 2025</small><p>

          </div>
          
          <p>There's a home that's built on a nice mountain. The members of this nuclear family all live a life that
requires them to spend a part of the day outside the house. Parents go out to attend work. The kids have school.
Knowing that there'll be no one (or worse, only kids) in the house for a period of time everyday, the family
realized it'd be nice to secure the perimeter of the house by setting up surveillance cameras. The family members consume technology but they aren't very technical themselves. They research a bit around before deciding on
the cameras they'll use to set the surveillance up using.</p>
<p>"Honey. These surveillance cameras also have a mobile app. It says so on the website."</p>
<p>"What if there happens to be an electricity cut? Cameras gonna go off."</p>
<p>"Humm. Yeah."</p>
<p>"Oh, found them. These ones have an internal battery that says it should last the camera for 2 hours."</p>
<p>"These cameras work on WiFi, but that's fine as we've already got our ONT on a UPS backup."</p>
<p>"Awesome! Karen from my office also uses similar cameras for their home."</p>
<p>"Let's get these!"</p>
<p>The family gets some nice cameras that they fit around the house. Their phones don't have to be connected to
their home WiFi since these "nice" cameras have come with a mobile app that allows them to see the video feed
of their cameras even if they are outside of their home. This means, the family can monitor their cameras from
their office workplace.</p>
<p>It's been a few months now with the cameras installed. Their house is safe. The mobile app notifies the
parents when their kids have returned safely from school. They're able to monitor their house during the
occasional power-outages. The video feeds stay on the (camera company's proprietary) cloud. Which is cool
as the parents are now able to access the past video feeds, even when the cameras are turned off.</p>
<p>Everything's looking good.</p>
<p>One day, dad gets a notification on his phone from the camera's mobile app: "Human presence detected!".
Dad thinks to himself without checking the camera feed:</p>
<p>"Oh cool. Wifey's sandals must be here."</p>
<p>He expects to receive a call from the delivery guy since the front door is locked.</p>
<p>"It's been a while, what's the guy doing..?"</p>
<p><em>Casually opens the camera app on his phone.</em></p>
<p>He sees two people with their faces masked up. They are leaving the house with a few sacks in their hands
to a car parked near the family's house. That spikes up dad's anxiety.</p>
<p>"...the heck?!"</p>
<p>Dials up 911 (or the equivalent) to send a dispatch to their house.</p>
<p>"Wait. This video feed was recorded 3 hours ago?!"</p>
<p>That is interesting. Why did the notification showed up now and not while the burglary was unfolding? Did the
cameras mess up?
Was it the software? Did the internet go down? No, that can't be so. The internet hardly ever goes down
this area, let alone such a coincidence with the robbery.</p>
<p>The master power control is present inside the house itself. It would've been very difficult to turn down
the power without first breaking into the house, which doesn't make sense as he'd have gotten the
notification if the burglars tried doing so. Also, the UPS would've lasted them a couple hours, both the
cameras and their home internet.</p>
<h2 id="what-could-ve-gone-wrong-here">What could've gone wrong here?</h2>
<p>One plausible possibility seems like the camera software indeed messed up somewhere.</p>
<p>Maybe the camera software for some reason failed to send a motion event to the company's proprietary cloud.</p>
<p>Maybe the company's cloud software failed to notify dad and mom's mobile app.</p>
<p>Maybe the camera failed to detect the humans wearing masks over their face as humans, since we had to
disable object detection due to high rate of false-positives in motion detection due the plants moving
with the wind.</p>
<p>Maybe the camera firmware auto-updated and broke itself yesterday.</p>
<p>Maybe the mobile app and notifications have been broken since the last update on the playstore/appstore
which happened a few days ago.</p>
<p>You can self-host all the above parts of software to get more fine control over the devices you own, which run
the above mentioned software, to reduce the possibility of the above issues. I feel this can easily take a
month to get into and solve the problem to a good extent, given the person is supposed to show up at their
office on weekdays and the person is technical enough to even consider attempting to solve the problem in
the first place.</p>
<p>Dealing with all of the above is something pretty much out of the question for your average neighbour.</p>
<p>The local police can't seem to get a grip on what happened. Of course, people change their clothes. and
any physically wearable and social masks.</p>
<p>However, the cameras and the company software were both godsend, so none of the above was an issue. It was
seen in the recorded video feed later on that the burglars looked to be carrying some sort of antenna-based
device?</p>
<p>"Wait. What is this antenna thingy that robbers look to have forgotten in our house??"</p>
<p>Bombsquad made sure it's not a bomb.</p>
<p>The family clicked pictures of the thing. The next day, they sent it over to this young distant relative of
theirs.</p>
<p>"We occasionally ask him to fix our printer. A very nice guy."</p>
<p>The relative takes a while to get back.</p>
<p>"Hmm. Is it a Raspberry Pi? It looks a Raspberry Pi Zero. Hacked up to a battery backup?"</p>
<p>"Oh, that antenna looks like an external WiFi adapter. I can read it saying ...ALFA??"</p>
<p>My guess is the burglars connected an external WiFi adapter to a RPi Zero, constantly broadcasting deauth
packets to the nearby APs, <em>cough cough</em> aircrack-ng is it called? Oh right, the family also used a WPA/WPA2
secure network. Isn't that what everybody sees when they're connecting to their favourite WiFi? Yeah, seems
it's suspectible to an attack that forces the access point to drop any connected clients if it receives this
specially crafted network packet. This must've went on until the battery ran out and the RPi forced itself
off from the lack of input power.</p>
<p>This exploit may not have worked with if the access point used was WPA3. But that is not what we're all doing,
right?</p>
<p>"So you say our cameras wouldn't connect to our WiFi because of this thing nearby?"</p>
<p>"But we tried to turn on this antenna thing using our uh.. what they call.. MicroUSB wall adapter and
our WiFi has been working fine for the past hour."</p>
<p>The filesystem present in the MicroSD card in the RPi is LUKS encrypted. Yep right, it asks for a key
to unlock at initrd when it's connected it to a monitor. Now to guess what it'd be.</p>
<p>"password"?</p>
<p>Yeah. Good luck.</p>

        </article>
      </div>
    </div>
  </div>
</div>


  
    
<footer class="footer text-muted">
	<div class="container">
		<div class="row">
			<div class="col-lg-8 order-last order-lg-first">
				<ul class="list-inline">
					
						<li class="list-inline-item">Powered by <a href="https://www.getzola.org/">Zola</a></li>
					
				</ul>
			</div>
			<div class="col-lg-8 order-first order-lg-last text-lg-end">
				<ul class="list-inline">
					
				</ul>
			</div>
		</div>
	</div>
</footer>

  

  
<script type="text/javascript" src="https://ritiek.github.io/js/main.js" defer></script>

  <script type="text/javascript" src="https://ritiek.github.io/plugins/elasticlunr.min.js"></script>
  <script type="text/javascript">
    console.log("Loading search index...");
    fetch("https://ritiek.github.io/search_index.en.json")
      .then(response => {
        console.log("Search index response:", response.status);
        if (!response.ok) {
          throw new Error('Search index not found');
        }
        return response.json();
      })
      .then(data => { 
        console.log("Search index loaded successfully");
        window.searchIndex = data;
        var script = document.createElement('script');
        script.src = "https://ritiek.github.io/js/search.js";
        document.body.appendChild(script);
      })
      .catch(error => {
        console.error("Error loading search index:", error);
      });
  </script>

  
</body>
</html>
